// ==UserScript==
// @name         我的农田
// @author       bug人@,Pinenutn
// @version      1.0.3
// @description  实现部分农田小游戏插件，使用<.成为农夫>开启游戏，<.农场指令>查看帮助
// @timestamp    1729357648
// @license      Apache-2.0
// @homepageURL  https://github.com/bugtower100/myfarm
// @updateUrl    https://mirror.ghproxy.com/https://raw.githubusercontent.com/bugtower100/myfarm/refs/heads/master/%E5%8F%AA%E6%98%AF%E7%94%A8%E6%9D%A5%E6%9B%B4%E6%96%B0%E7%9A%84%E9%A1%B5%E9%9D%A2.js
// ==/UserScript==

(()=>{var M=class v{constructor(){this.lastDate=new Date,this.currentWeather=this.getRandomWeather()}static getInstance(){return v.instance||(v.instance=new v),v.instance}getRandomWeather(){let e=Math.random();return e<.5?"\u6674\u5929":e<.8?"\u96E8\u5929":e<.85?"\u5E72\u65F1":e<.95?"\u66B4\u98CE\u96E8":"\u4E30\u6536\u65E5"}updateWeather(){let e=new Date;e.getDate()!==this.lastDate.getDate()?(this.currentWeather=this.getRandomWeather(),this.lastDate=e,console.log(`\u5929\u6C14\u5DF2\u66F4\u65B0\u4E3A\uFF1A${this.currentWeather}`)):console.log(`\u5929\u6C14\u672A\u66F4\u65B0\uFF0C\u5F53\u524D\u5929\u6C14\u4E3A\uFF1A${this.currentWeather}`)}getCurrentWeather(){return this.currentWeather}getWeatherInfo(){return`\u5F53\u524D\u5929\u6C14: ${this.currentWeather}`}};var V={\u6674\u5929:1,\u96E8\u5929:.8,\u5E72\u65F1:1.5,\u66B4\u98CE\u96E8:2.5,\u4E30\u6536\u65E5:.5},T={\u9632\u98CE\u8349\u79CD\u5B50:{price:50,level:1},\u80E1\u841D\u535C\u79CD\u5B50:{price:60,level:1},\u767D\u841D\u535C\u79CD\u5B50:{price:70,level:2},\u82B1\u6930\u83DC\u79CD\u5B50:{price:70,level:2},\u5C0F\u767D\u83DC\u79CD\u5B50:{price:70,level:2},\u9752\u8C46\u79CD\u5B50:{price:70,level:2},\u80A5\u6599:{price:100,level:2},\u571F\u8C46\u79CD\u5B50:{price:75,level:3},\u5927\u9EC4\u79CD\u5B50:{price:80,level:3},\u7518\u84DD\u83DC\u79CD\u5B50:{price:80,level:3},\u8461\u8404\u79CD\u5B50:{price:80,level:3},\u5411\u65E5\u8475\u79CD\u5B50:{price:90,level:3},\u73AB\u7470\u82B1\u79CD\u5B50:{price:90,level:3},\u8349\u8393\u79CD\u5B50:{price:100,level:4},\u8FA3\u6912\u79CD\u5B50:{price:100,level:4},\u751C\u74DC\u79CD\u5B50:{price:105,level:4},\u7EA2\u53F6\u5377\u5FC3\u83DC\u79CD\u5B50:{price:105,level:4},\u6768\u6843\u79CD\u5B50:{price:110,level:4},\u90C1\u91D1\u9999\u79CD\u5B50:{price:105,level:4},\u73AB\u7470\u4ED9\u5B50\u79CD\u5B50:{price:110,level:4},\u8304\u5B50\u79CD\u5B50:{price:110,level:5},\u82CB\u83DC\u79CD\u5B50:{price:110,level:5},\u5C71\u836F\u79CD\u5B50:{price:110,level:5},\u590F\u5B63\u4EAE\u7247\u79CD\u5B50:{price:120,level:5},\u865E\u7F8E\u4EBA\u79CD\u5B50:{price:150,level:5},\u6843\u6811\u79CD\u5B50:{price:120,level:5},\u82F9\u679C\u6811\u79CD\u5B50:{price:120,level:5},\u9999\u8549\u6811\u79CD\u5B50:{price:150,level:5},\u5B9D\u77F3\u751C\u8393\u79CD\u5B50:{price:200,level:5},\u6269\u5BB9\u7530\u5730:{price:500,level:3},\u9C7C\u9975:{price:20,level:4},\u6269\u5BB9\u7530\u5730ii:{price:1e3,level:5}},O=class{constructor(){this.weatherManager=M.getInstance()}updateWeather(){this.weatherManager.updateWeather()}getCurrentWeather(){return this.weatherManager.getCurrentWeather()}getWeatherInfo(){return this.weatherManager.getWeatherInfo()}},P=class v{constructor(e,t){this.stealCooldown=60*1e3;this.id=e,this.name=t,this.fields=6,this.money=200,this.level=1,this.experience=0,this.crops={},this.warehouse={\u9632\u98CE\u8349\u79CD\u5B50:6},this.lastStealTime=0,this.weatherSystem=new O,this.lastSignInDate="",this.purchasedFields={},this.fishPond=0,this.lastFishPondRefresh=""}static getData(e){try{let t=JSON.parse(seal.ext.find("\u6211\u7684\u519C\u7530\u63D2\u4EF6").storageGet(e)||"{}");if(Object.keys(t).length===0)return null;let s=new v(e,t.name);return s.fields=t.fields||6,s.money=t.money||200,s.level=t.level||1,s.experience=t.experience||0,s.crops=t.crops||{},s.warehouse=t.warehouse||{\u9632\u98CE\u8349\u79CD\u5B50:6},s.lastStealTime=t.lastStealTime||0,s.lastSignInDate=t.lastSignInDate||"",s.purchasedFields=t.purchasedFields||{},s.fishPond=t.fishPond||0,s.lastFishPondRefresh=t.lastFishPondRefresh||"",s}catch(t){return null}}saveData(){seal.ext.find("\u6211\u7684\u519C\u7530\u63D2\u4EF6").storageSet(this.id.toString(),JSON.stringify(this))}checkLevelUp(){let t=[100,500,1e3,1500,2e3,2500,3e3,3600,4e3,5e3][this.level-1];return this.experience>=t?(this.level++,this.experience-=t,this.saveData(),this.level===4?`\u606D\u559C\uFF01\u60A8\u5347\u7EA7\u5230${this.level}\u7EA7\u4E86\uFF0C\u53EF\u4EE5\u89E3\u9501\u66F4\u591A\u5546\u54C1\u4E86\u3002
\u606D\u559C\u60A8\u89E3\u9501\u9C7C\u5858\uFF0C\u5F00\u542F\u9493\u9C7C\u529F\u80FD\uFF01`:this.level===3?`\u606D\u559C\uFF01\u60A8\u5347\u7EA7\u5230${this.level}\u7EA7\u4E86\uFF0C\u53EF\u4EE5\u89E3\u9501\u66F4\u591A\u5546\u54C1\u4E86\u3002
\u5468\u56F4\u7684\u795E\u79D8\u5C0F\u7CBE\u7075\u5F00\u59CB\u6CE8\u610F\u4F60\u7684\u7530\u5730\u4E86\uFF01`:`\u606D\u559C\uFF01\u60A8\u5347\u7EA7\u5230${this.level}\u7EA7\u4E86\uFF0C\u53EF\u4EE5\u89E3\u9501\u66F4\u591A\u5546\u54C1\u4E86\u3002`):null}fish(){let e=new I(this.id,this.name);for(let t in e)e[t]=this[t]||e[t];return e.fish()}plantCrop(e,t){if(!e.endsWith("\u79CD\u5B50"))return"\u8BE5\u7269\u54C1\u4E0D\u53EF\u79CD\u690D\u3002";if(!this.warehouse[e])return`\u4F60\u6CA1\u6709${e}\uFF0C\u8BF7\u8D2D\u4E70\u540E\u79CD\u690D\u3002`;let s=this.fields-Object.keys(this.crops).length;if(t>s)return`\u4F60\u53EA\u6709${s}\u5757\u7A7A\u95F2\u7530\u5730\u3002`;if(this.warehouse[e]<t)return`\u4F60\u7684\u4ED3\u5E93\u4E2D\u6CA1\u6709\u8DB3\u591F\u7684${e}\u3002`;console.log(JSON.stringify(this.weatherSystem));let o=V[this.weatherSystem.getCurrentWeather()],h=Math.random()*(4-.5)+.5,d=new Date().getTime()+h*60*60*1e3*o,c=.2,m=Math.random()<c;if(console.log(`\u4E8B\u4EF6\u89E6\u53D1\u6982\u7387: ${c}, \u4E8B\u4EF6\u662F\u5426\u89E6\u53D1: ${m}`),m){let p=Math.random()<.33?"\u5C0F\u7CBE\u7075\u50AC\u719F":Math.random()<.5?"\u5973\u5DEB\u836F\u6C34\u81F4\u6B7B":"\u72D7\u718A\u538B\u574F\u4F5C\u7269";if(console.log(`\u4E8B\u4EF6\u7C7B\u578B: ${p}`),p==="\u5C0F\u7CBE\u7075\u50AC\u719F"&&this.level>=3){d=h*60*60*1e3*o*.8+Date.now();for(let y=0;y<t;y++){let g=this.getNextAvailableField();this.crops[g]={seed:e,harvestTime:d,stolen:!1}}return this.warehouse[e]-=t,this.warehouse[e]===0&&delete this.warehouse[e],this.saveData(),`\u54E6\u5440\uFF0C\u4F60\u7684\u7530\u5730\u5438\u5F15\u5230\u8FD9\u7FA4\u53EF\u7231\u7684\u5C0F\u4E1C\u897F\u4E86\u554A~\u4ED6\u4EEC\u7ED9\u7530\u5730\u65BD\u52A0\u4E86\u9B54\u6CD5\u54E6\u3002
\u6210\u529F\u79CD\u690D${t}\u5757${e}\uFF0C\u6210\u719F\u65F6\u95F4\u4E3A${this.formatTime(h*.8)}\u3002`}else if(p==="\u5973\u5DEB\u836F\u6C34\u81F4\u6B7B"){this.crops={};let y=Math.floor(Math.random()*51)+50,g=Math.floor(Math.random()*4)+3;return this.money+=y,this.warehouse.\u80A5\u6599||(this.warehouse.\u80A5\u6599=0),this.warehouse.\u80A5\u6599+=g,this.saveData(),`\u545C\u54C7\uFF01\u8DEF\u8FC7\u7684\u5B9E\u4E60\u5973\u5DEB\u4E0D\u5C0F\u5FC3\u628A\u836F\u6C34\u5168\u6D12\u4E86\uFF0C\u4F60\u7684\u519C\u4F5C\u7269\u5168\u6CA1\u4E86\uFF01\u5BF9\u65B9\u5F88\u62B1\u6B49\uFF0C\u4E8E\u662F\u7ED9\u4E86\u4F60\u7684\u8865\u507F~\u83B7\u5F97${y}\u91D1\u5E01\u548C\u80A5\u6599\xD7${g}\u3002`}else if(p==="\u72D7\u718A\u538B\u574F\u4F5C\u7269"&&t>2){let y=Math.floor(Math.random()*3)+3,g=Math.min(y,t);return Object.keys(this.crops).sort(()=>.5-Math.random()).slice(0,g).forEach(D=>delete this.crops[D]),this.saveData(),`\u4E0D\u597D\u4E86\uFF0C\u4E00\u53EA\u8DEF\u8FC7\u7684\u72D7\u718A\u5728\u4F60\u7684\u7530\u5730\u91CC\u7761\u4E86\u4E00\u89C9\uFF0C\u538B\u574F\u4E86${g}\u5757\u4F5C\u7269...`}}for(let p=0;p<t;p++){let y=this.getNextAvailableField();this.crops[y]={seed:e,harvestTime:d,stolen:!1}}return this.warehouse[e]-=t,this.warehouse[e]===0&&delete this.warehouse[e],this.saveData(),`\u6210\u529F\u79CD\u690D${t}\u5757${e}\uFF0C\u6210\u719F\u65F6\u95F4\u4E3A${this.formatTime(h)}\u3002`}getNextAvailableField(){let e=1;for(;this.crops[`\u7530\u5730${e}`];)e++;return`\u7530\u5730${e}`}harvestAllCrops(){let e=new Date().getTime(),t={},s=0,o=0;for(let c in this.crops)if(this.crops[c].harvestTime<=e&&!this.crops[c].stolen){let m=this.crops[c].seed,p=m.replace("\u79CD\u5B50",""),g=T[m].price*.5,x=Math.floor(Math.random()*11)+10;t[p]||(t[p]=0),t[p]++,s+=g,o+=x,delete this.crops[c],this.warehouse[p]||(this.warehouse[p]=0),this.warehouse[p]++}if(Object.keys(t).length===0)return"\u5F53\u524D\u7530\u5730\u6682\u65F6\u6CA1\u6709\u6210\u719F\u4F5C\u7269\u54E6~";this.money+=s,this.experience+=o,this.saveData();let h=this.checkLevelUp(),d="\u6210\u529F\u6536\u83B7";for(let c in t)d+=` ${c}\xD7${t[c]}`;return d+=`\uFF0C\u83B7\u5F97${s}\u91D1\u5E01\u548C${o}\u7ECF\u9A8C\u3002`,h&&(d+=`
${h}`),d}harvestCrop(e){if(e==="all")return this.harvestAllCrops();if(!this.crops[e]||this.crops[e].harvestTime>new Date().getTime()||this.crops[e].stolen)return`${e}\u8FD8\u6CA1\u6709\u6210\u719F\u4F5C\u7269\u54E6\uFF01`;let t=.05,s=Math.random()<t;if(console.log(`\u5192\u9669\u8005\u5077\u83DC\u4E8B\u4EF6\u89E6\u53D1\u6982\u7387: ${t}, \u4E8B\u4EF6\u662F\u5426\u89E6\u53D1: ${s}`),s){console.log("\u5192\u9669\u8005\u5077\u83DC\u4E8B\u4EF6\u89E6\u53D1");let C=Object.keys(this.crops).filter($=>this.crops[$].harvestTime<=new Date().getTime()&&!this.crops[$].stolen);if(console.log(`\u6210\u719F\u7530\u5730\u6570\u91CF: ${C.length}`),C.length>0){let $=Math.floor(Math.random()*2)+1,D=C.slice(0,$);console.log(`\u88AB\u5077\u8D70\u7684\u7530\u5730\u6570\u91CF: ${D.length}`),D.forEach(F=>{delete this.crops[F],console.log(`\u7530\u5730 ${F} \u88AB\u5077\u8D70`)});let W=Math.floor(Math.random()*51)+50,k=Object.keys(T).filter(F=>F.endsWith("\u79CD\u5B50")),R=k[Math.floor(Math.random()*k.length)],N=Math.floor(Math.random()*3)+3;return this.money+=W,this.warehouse[R]||(this.warehouse[R]=0),this.warehouse[R]+=N,this.saveData(),`\u8DEF\u8FC7\u7684\u5192\u9669\u8005\u91C7\u8D70\u4E86\u4F60\u7530\u5730\u91CC\u7684\u4F5C\u7269\uFF01\u4E0D\u8FC7\u6211\u4EEC\u53CA\u65F6\u8FFD\u4E0A\u4E86\u4ED6\u4EEC~
\u603B\u4E4B\u8981\u56DE\u4E86\u4E00\u4E9B\u62A5\u916C\u5462...\u4E5F\u4E0D\u7B97\u5DEE\uFF1F
\u83B7\u5F97${W}\u91D1\u5E01\u548C${R}\xD7${N}\u3002`}else console.log("\u6CA1\u6709\u6210\u719F\u7684\u7530\u5730\u53EF\u4EE5\u88AB\u5077")}else console.log("\u5192\u9669\u8005\u5077\u83DC\u4E8B\u4EF6\u672A\u89E6\u53D1");let o=this.crops[e].seed,h=o.replace("\u79CD\u5B50",""),c=T[o].price*.5,m=Math.floor(Math.random()*11)+10,p=this.level*.5;if(console.log(JSON.stringify(this.weatherSystem)),this.weatherSystem.getCurrentWeather()==="\u4E30\u6536\u65E5"&&(p+=5),Math.random()<p/100)return c*=2,m*=2,this.warehouse[h]+=2,this.saveData(),`\u54E6\u5440\u54E6\u5440~\u7B80\u76F4\u662F\u5927\u4E30\u6536\uFF01
\u6210\u529F\u6536\u83B7${h}\xD72\uFF0C\u83B7\u5F97${c}\u91D1\u5E01\u548C${m}\u7ECF\u9A8C\u3002`;this.money+=c,this.experience+=m,delete this.crops[e],this.warehouse[h]||(this.warehouse[h]=0),this.warehouse[h]++,this.saveData();let g=this.checkLevelUp(),x=`\u6210\u529F\u6536\u83B7${h}\uFF0C\u83B7\u5F97${c}\u91D1\u5E01\u548C${m}\u7ECF\u9A8C\u3002`;return g&&(x+=`
${g}`),x}getFarmInfo(){let e=`\u7528\u6237\u540D: ${this.name}
\u91D1\u5E01: ${this.money}
\u7B49\u7EA7: ${this.level}
\u7ECF\u9A8C: ${this.experience}
`,t=new Date().getTime();for(let s in this.crops){let o=(this.crops[s].harvestTime-t)/36e5;o<=0?e+=`${s}: ${this.crops[s].seed.replace("\u79CD\u5B50","")}\uFF08\u5DF2\u6210\u719F\uFF09
`:e+=`${s}: ${this.crops[s].seed}\uFF0C\u5269\u4F59\u65F6\u95F4: ${this.formatTime(o)}
`}return e}formatTime(e){let t=Math.floor(e),s=Math.round((e-t)*60);return`${t}\u5C0F\u65F6${s}\u5206\u949F`}getStoreInfo(){let e=`\u5546\u5E97\u5546\u54C1:
`;for(let t in T){let s=T[t].level;t==="\u6269\u5BB9\u7530\u5730"&&this.purchasedFields[s]||(e+=`${t}: ${T[t].price}\u91D1\u5E01 (\u7B49\u7EA7${T[t].level})
`)}return e}buyItem(e,t=1){if(!T[e])return`\u5546\u5E97\u4E2D\u6CA1\u6709${e}\u3002`;if(this.level<T[e].level)return`\u4F60\u7684\u7B49\u7EA7\u4E0D\u591F\u8D2D\u4E70${e}\uFF0C\u518D\u52A0\u628A\u52B2\u5427~`;if(isNaN(t)||t<=0||!Number.isInteger(t))return"\u8BF7\u8F93\u5165\u4E00\u4E2A\u6709\u6548\u7684\u8D2D\u4E70\u6570\u91CF\u54E6";let s=T[e].price*t;if(this.money<s)return`\u55EF...\u4F60\u7684\u91D1\u5E01\u4E0D\u591F\u8D2D\u4E70${t}\u4E2A${e}\u3002`;if(e==="\u6269\u5BB9\u7530\u5730"){let o=T[e].level;if(this.purchasedFields[o])return"\u4F60\u5DF2\u7ECF\u8D2D\u4E70\u8FC7\u8BE5\u7B49\u7EA7\u7684\u6269\u5BB9\u7530\u5730\u5566\uFF01";this.fields+=t,this.purchasedFields[o]=!0}else if(e==="\u6269\u5BB9\u7530\u5730ii"){if(this.purchasedFields[5])return"\u4F60\u5DF2\u7ECF\u8D2D\u4E70\u8FC75\u7EA7\u6269\u5BB9\u7530\u5730\u5566\uFF01";this.fields+=1,this.purchasedFields[5]=!0,delete T.\u6269\u5BB9\u7530\u5730ii}else this.warehouse[e]||(this.warehouse[e]=0),this.warehouse[e]+=t;return this.money-=s,this.saveData(),`\u94DB\u94DB\u2014\u2014\u6210\u529F\u8D2D\u4E70${e}${t}\u4E2A\u3002`}sellItem(e,t=1){if(isNaN(t)||!Number.isInteger(t)||t<=0)return"\u8BF7\u8F93\u5165\u6709\u6548\u7684\u51FA\u552E\u6570\u91CF\u3002";if(e==="\u80A5\u6599")return"\u4E0D\u597D\u610F\u601D\uFF0C\u672C\u5E97\u4E0D\u6536\u80A5\u6599\u54E6~";if(!this.warehouse[e])return`\u4F60\u7684\u4ED3\u5E93\u4E2D\u6CA1\u6709${e}\u54E6`;if(this.warehouse[e]<t)return`\u4F60\u7684\u4ED3\u5E93\u4E2D\u6CA1\u6709\u8DB3\u591F\u7684${e}\u5566\uFF01`;let s;if(e.endsWith("\u79CD\u5B50"))s=T[e].price*.8;else if(e==="\u9C7C\u9975")s=T[e].price*.5;else if(this.isFish(e))s=this.getFishPrice(e);else{let h=e+"\u79CD\u5B50";s=T[h].price*1.25}let o=s*t;return this.money+=o,this.warehouse[e]-=t,this.warehouse[e]===0&&delete this.warehouse[e],this.saveData(),`\u6210\u529F\u51FA\u552E${e}${t}\u4E2A\uFF0C\u83B7\u5F97${o}\u91D1\u5E01~`}isFish(e){return["\u9CA4\u9C7C","\u9CB1\u9C7C","\u5C0F\u5634\u9C88\u9C7C","\u592A\u9633\u9C7C","\u9CC0\u9C7C","\u6C99\u4E01\u9C7C","\u6CB3\u9C88","\u9CA2\u9C7C","\u9CB7\u9C7C","\u7EA2\u9CB7\u9C7C","\u6D77\u53C2","\u8679\u9CDF\u9C7C","\u5927\u773C\u9C7C","\u897F\u9CB1","\u5927\u5934\u9C7C","\u5927\u5634\u9C88\u9C7C","\u9C91\u9C7C","\u9B3C\u9C7C","\u7F57\u975E\u9C7C","\u6728\u8DC3\u9C7C","\u72EE\u5B50\u9C7C","\u6BD4\u76EE\u9C7C","\u5927\u6BD4\u76EE\u9C7C","\u5348\u591C\u9CA4\u9C7C","\u53F2\u83B1\u59C6\u9C7C","\u867E\u864E\u9C7C","\u7EA2\u9CBB\u9C7C","\u9752\u82B1\u9C7C","\u72D7\u9C7C","\u864E\u7EB9\u9CDF\u9C7C","\u84DD\u94C1\u997C\u9C7C","\u6C99\u9C7C"].includes(e)}getFishPrice(e){return{\u9CA4\u9C7C:20,\u9CB1\u9C7C:30,\u5C0F\u5634\u9C88\u9C7C:30,\u592A\u9633\u9C7C:45,\u9CC0\u9C7C:45,\u6C99\u4E01\u9C7C:45,\u6CB3\u9C88:50,\u9CA2\u9C7C:50,\u9CB7\u9C7C:50,\u7EA2\u9CB7\u9C7C:55,\u6D77\u53C2:55,\u8679\u9CDF\u9C7C:55,\u5927\u773C\u9C7C:60,\u897F\u9CB1:60,\u5927\u5934\u9C7C:60,\u5927\u5634\u9C88\u9C7C:60,\u9C91\u9C7C:60,\u9B3C\u9C7C:65,\u7F57\u975E\u9C7C:65,\u6728\u8DC3\u9C7C:65,\u72EE\u5B50\u9C7C:65,\u6BD4\u76EE\u9C7C:70,\u5927\u6BD4\u76EE\u9C7C:70,\u5348\u591C\u9CA4\u9C7C:70,\u53F2\u83B1\u59C6\u9C7C:70,\u867E\u864E\u9C7C:70,\u7EA2\u9CBB\u9C7C:75,\u9752\u82B1\u9C7C:75,\u72D7\u9C7C:75,\u864E\u7EB9\u9CDF\u9C7C:75,\u84DD\u94C1\u997C\u9C7C:75,\u6C99\u9C7C:75}[e]||0}getWarehouseInfo(){let e=`\u4ED3\u5E93\u7269\u54C1:
`;for(let t in this.warehouse)e+=`${t}: ${this.warehouse[t]}
`;return e}removeCrop(e){return this.crops[e]?(delete this.crops[e],this.saveData(),`\u6210\u529F\u94F2\u9664${e}\u7684\u4F5C\u7269\u3002`):`${e}\u6CA1\u6709\u79CD\u690D\u4F5C\u7269\u3002`}stealCrop(e){let t=Date.now();if(this.lastStealTime!==0&&t-this.lastStealTime<this.stealCooldown)return`\u9644\u8FD1\u8FD8\u6709\u4EBA\u770B\u7740\u5462\uFF0C\u518D\u7B49${Math.ceil((this.stealCooldown-(t-this.lastStealTime))/1e3)}\u79D2\u540E\u518D\u8BD5\u5427...`;let s=Object.keys(e.crops).filter(c=>e.crops[c].harvestTime<=t&&!e.crops[c].stolen);if(s.length===0)return"\u8FD9\u5BB6\u4EBA\u7684\u7530\u5730\u4E2D\u53EF\u6CA1\u6709\u6210\u719F\u7684\u4F5C\u7269\uFF0C\u6362\u4E2A\u76EE\u6807\u5427~";let o=s[Math.floor(Math.random()*s.length)],d=e.crops[o].seed.replace("\u79CD\u5B50","");return this.warehouse[d]||(this.warehouse[d]=0),this.warehouse[d]++,delete e.crops[o],this.lastStealTime=t,this.saveData(),e.saveData(),`\u55EF\u54FC~\u6210\u529F\u5077\u53D6\u5230${d}\u5566\uFF01`}changeName(e){return this.name=e,this.saveData(),`\u8981\u6539\u540D\u6210${e}\u5417\uFF1F\u597D\u7684\u597D\u7684\uFF0C\u4E0D\u4F1A\u662F\u505A\u4E86\u4EC0\u4E48\u4E8F\u5FC3\u4E8B\u5427~`}useFertilizer(e){if(!this.warehouse.\u80A5\u6599)return"\u4F60\u7684\u4ED3\u5E93\u4E2D\u6CA1\u6709\u80A5\u6599\u54E6";if(!this.crops[e])return`${e}\u6CA1\u6709\u79CD\u690D\u4F5C\u7269\u3002`;let t=new Date().getTime(),s=(this.crops[e].harvestTime-t)/(60*60*1e3);return s<=0?`${e}\u7684\u4F5C\u7269\u5DF2\u7ECF\u6210\u719F\u5566\uFF01`:(this.crops[e].harvestTime-=s*.5*60*60*1e3,this.warehouse.\u80A5\u6599--,this.warehouse.\u80A5\u6599===0&&delete this.warehouse.\u80A5\u6599,this.saveData(),`\u6210\u529F\u5BF9${e}\u4F7F\u7528\u9B54...\u80A5\u6599\uFF0C\u5269\u4F59\u65F6\u95F4\u51CF\u5C11\u4E00\u534A~`)}getLastStealTime(){return this.lastStealTime}discardItem(e,t=1){return this.warehouse[e]?isNaN(t)||t<=0||!Number.isInteger(t)?"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u6570\u76EE\u3002":this.warehouse[e]<t?"\u8981\u4E22\u5F03\u7684\u6570\u76EE\u592A\u591A\u5566\uFF01":(this.warehouse[e]-=t,this.warehouse[e]===0&&delete this.warehouse[e],this.saveData(),`\u6210\u529F\u4E22\u5F03${t}\u4E2A${e}\u3002`):`\u4F60\u6CA1\u6709${e}\u7269\u54C1\u3002`}},I=class v extends P{constructor(e,t){super(e,t),this.wormCatchCount=0,this.explorationType=null,this.explorationStartTime=null}static getData(e){try{let t=JSON.parse(seal.ext.find("\u6211\u7684\u519C\u7530\u63D2\u4EF6").storageGet(e)||"{}");if(Object.keys(t).length===0)return null;let s=new v(e,t.name);for(let o in t)o!=="weatherSystem"&&(s[o]=t[o]||s[o]);return s}catch(t){return console.log(t),null}}refreshFishPond(){let t=new Date().toDateString();this.lastFishPondRefresh!==t&&(this.fishPond=Math.floor(Math.random()*11)+15,this.lastFishPondRefresh=t,this.saveData())}fish(){if(this.refreshFishPond(),this.fishPond<=0)return"\u9C7C\u5858\u4E2D\u7684\u9C7C\u5DF2\u7ECF\u6CA1\u6709\u4E86\uFF0C\u660E\u5929\u518D\u6765\u5427~";if(!this.warehouse.\u9C7C\u9975)return"\u4F60\u8FD8\u6CA1\u6709\u9C7C\u9975\u5462\uFF0C\u5148\u53BB\u5546\u5E97\u4E70\u70B9\u5566~";if(this.warehouse.\u9C7C\u9975--,this.warehouse.\u9C7C\u9975===0&&delete this.warehouse.\u9C7C\u9975,!(Math.random()<.55))return this.fishPond-=.5,this.saveData(),"\u54CE\u5440\uFF01\u9C7C\u8DD1\u4E86...";let s="";switch(this.level){case 4:s=this.getRandomFishType(["\u9CA4\u9C7C","\u9CB1\u9C7C","\u5C0F\u5634\u9C88\u9C7C","\u592A\u9633\u9C7C","\u9CC0\u9C7C"]);break;case 5:s=this.getRandomFishType(["\u9CA4\u9C7C","\u9CB1\u9C7C","\u5C0F\u5634\u9C88\u9C7C","\u592A\u9633\u9C7C","\u9CC0\u9C7C","\u6C99\u4E01\u9C7C","\u6CB3\u9C88","\u9CA2\u9C7C","\u9CB7\u9C7C","\u7EA2\u9CB7\u9C7C","\u6D77\u53C2","\u8679\u9CDF\u9C7C"]);break;case 6:s=this.getRandomFishType(["\u9CA4\u9C7C","\u9CB1\u9C7C","\u5C0F\u5634\u9C88\u9C7C","\u592A\u9633\u9C7C","\u9CC0\u9C7C","\u6C99\u4E01\u9C7C","\u6CB3\u9C88","\u9CA2\u9C7C","\u9CB7\u9C7C","\u7EA2\u9CB7\u9C7C","\u6D77\u53C2","\u8679\u9CDF\u9C7C","\u5927\u773C\u9C7C","\u897F\u9CB1","\u5927\u5934\u9C7C","\u5927\u5634\u9C88\u9C7C","\u9C91\u9C7C","\u9B3C\u9C7C"]);break;case 7:s=this.getRandomFishType(["\u9CA4\u9C7C","\u9CB1\u9C7C","\u5C0F\u5634\u9C88\u9C7C","\u592A\u9633\u9C7C","\u9CC0\u9C7C","\u6C99\u4E01\u9C7C","\u6CB3\u9C88","\u9CA2\u9C7C","\u9CB7\u9C7C","\u7EA2\u9CB7\u9C7C","\u6D77\u53C2","\u8679\u9CDF\u9C7C","\u5927\u773C\u9C7C","\u897F\u9CB1","\u5927\u5934\u9C7C","\u5927\u5634\u9C88\u9C7C","\u9C91\u9C7C","\u9B3C\u9C7C","\u7F57\u975E\u9C7C","\u6728\u8DC3\u9C7C","\u72EE\u5B50\u9C7C","\u6BD4\u76EE\u9C7C","\u5927\u6BD4\u76EE\u9C7C","\u5348\u591C\u9CA4\u9C7C"]);break;default:s=this.getRandomFishType(["\u9CA4\u9C7C","\u9CB1\u9C7C","\u5C0F\u5634\u9C88\u9C7C","\u592A\u9633\u9C7C","\u9CC0\u9C7C","\u6C99\u4E01\u9C7C","\u6CB3\u9C88","\u9CA2\u9C7C","\u9CB7\u9C7C","\u7EA2\u9CB7\u9C7C","\u6D77\u53C2","\u8679\u9CDF\u9C7C","\u5927\u773C\u9C7C","\u897F\u9CB1","\u5927\u5934\u9C7C","\u5927\u5634\u9C88\u9C7C","\u9C91\u9C7C","\u9B3C\u9C7C","\u7F57\u975E\u9C7C","\u6728\u8DC3\u9C7C","\u72EE\u5B50\u9C7C","\u6BD4\u76EE\u9C7C","\u5927\u6BD4\u76EE\u9C7C","\u5348\u591C\u9CA4\u9C7C","\u53F2\u83B1\u59C6\u9C7C","\u867E\u864E\u9C7C","\u7EA2\u9CBB\u9C7C","\u9752\u82B1\u9C7C","\u72D7\u9C7C","\u864E\u7EB9\u9CDF\u9C7C","\u84DD\u94C1\u997C\u9C7C","\u6C99\u9C7C"])}let o=Math.random(),h;return o<.7?h=parseFloat((Math.random()*1+2).toFixed(1)):o<.8?h=parseFloat((Math.random()*1+1).toFixed(1)):o<.9?h=parseFloat((Math.random()*1+3).toFixed(1)):o<.95?h=parseFloat((Math.random()*1+5).toFixed(1)):h=parseFloat((Math.random()*1+0).toFixed(1)),this.warehouse[s]||(this.warehouse[s]=0),this.warehouse[s]++,this.fishPond--,this.saveData(),`\u7B49\u5F85...\u7B49\u5F85...\u6210\u529F\u9493\u5230\u4E00\u6761\u957F\u5EA6\u4E3A${h}\u5C3A\u7684${s}\uFF01`}getRandomFishType(e){return e[Math.floor(Math.random()*e.length)]}catchWorms(){return this.level<4?"\u4F60\u7684\u7B49\u7EA7\u4E0D\u591F\u54E6\uFF0C\u518D\u7B49\u7B49\u518D\u6765\u5427\uFF01":M.getInstance().getCurrentWeather()!=="\u96E8\u5929"?"\u4ECA\u5929\u53EF\u6CA1\u6709\u86AF\u8693\u51FA\u6765\u554A...":this.wormCatchCount>=7?"\u8FD9\u91CC\u5DF2\u7ECF\u6CA1\u6709\u86AF\u8693\u4E86...":Math.random()<.7?(this.warehouse.\u9C7C\u9975||(this.warehouse.\u9C7C\u9975=0),this.warehouse.\u9C7C\u9975++,this.wormCatchCount++,this.saveData(),"\u606D\u559C\u4F60\u6355\u6349\u5230\u4E86\u86AF\u8693\uFF01"):(this.wormCatchCount++,this.saveData(),"\u4F60\u6316\u4E86\u534A\u5929\u571F\uFF0C\u90FD\u6CA1\u627E\u5230\u86AF\u8693\uFF0C\u6709\u70B9\u53EF\u601C\u554A~")}getExplorationType(){return this.explorationType}explore(e,t,s){if(this.explorationType){let m=this.getExplorationRemainingTime();return console.log(`\u5F53\u524D\u8FDC\u822A\u72B6\u6001: ${this.explorationType}, \u5269\u4F59\u65F6\u95F4: ${m}`),`\u4F60\u7684\u8239\u961F\u6B63\u5728\u63A2\u7D22\u4E2D\uFF0C\u8BA9\u6211\u770B\u770B...\u55EF\uFF0C\u8FD8\u6709${m}\u624D\u4F1A\u56DE\u6765\u54E6~`}let h={\u8FD1\u6D77\u8FDC\u822A:{duration:5*60*60*1e3,cost:1e3,reward:{minGold:1200,maxGold:1500,seeds:7}},\u8FDC\u6D77\u63A2\u7D22:{duration:8*60*60*1e3,cost:3e3,reward:{minGold:3200,maxGold:4e3,seeds:15,fish:5}},\u968F\u673A\u63A2\u7D22:{duration:12*60*60*1e3,cost:5e3,reward:{minGold:3e3,maxGold:8e3,seeds:{min:10,max:20},fish:{min:3,max:10}}}}[e];if(!h)return`\u9009\u62E9\u8FDC\u822A\u7C7B\u578B\uFF1A
1.\u8FD1\u6D77\u8FDC\u822A\uFF085\u5C0F\u65F6\uFF0C1000\u91D1\u5E01\uFF09
2.\u8FDC\u6D77\u63A2\u7D22\uFF088\u5C0F\u65F6\uFF0C3000\u91D1\u5E01\uFF09
3.\u968F\u673A\u63A2\u7D22\uFF0812\u5C0F\u65F6\uFF0C5000\u91D1\u5E01\uFF09

\u7528\u201C.\u8FDC\u822A<\u63A2\u7D22\u7C7B\u578B>\u5F00\u542F\u8FDC\u822A\u5427\uFF01
*\u8FDC\u822A\u7ED3\u675F\u540E\u4F1A\u6765\u627E\u4F60\u7684\uFF01`;if(this.money<h.cost)return`\u4F60\u7684\u91D1\u5E01\u4E0D\u591F\u8FDB\u884C${e}\u54E6~`;this.money-=h.cost,this.explorationType=e,this.explorationStartTime=Date.now(),this.saveData();let d=seal.ext.find("\u6211\u7684\u519C\u7530\u63D2\u4EF6").storageGet("VoyageTasks"),c=d?JSON.parse(d):[];return c.push({reachTime:Date.now()+h.duration+3e4,userId:this.id,replyCtx:[t.endPoint.userId,s.guildId,s.groupId,s.sender.userId,s.messageType==="private"]}),seal.ext.find("\u6211\u7684\u519C\u7530\u63D2\u4EF6").storageSet("VoyageTasks",JSON.stringify(c)),console.log(`\u5B58\u50A8\u540E explorationType: ${this.explorationType}, explorationStartTime: ${this.explorationStartTime}`),"\u4F60\u7684\u8239\u961F\u51FA\u822A\u5566~"}getExplorationRemainingTime(){if(!(this.explorationType&&this.explorationStartTime))return"0\u79D2";let t={\u8FD1\u6D77\u8FDC\u822A:5*60*60*1e3,\u8FDC\u6D77\u63A2\u7D22:8*60*60*1e3,\u968F\u673A\u63A2\u7D22:12*60*60*1e3}[this.explorationType],s=Date.now()-this.explorationStartTime,o=t-s;if(o<=0)return"0\u79D2";let h=Math.floor(o/(60*60*1e3)),d=Math.floor(o%(60*60*1e3)/(60*1e3)),c=Math.floor(o%(60*1e3)/1e3);return`${h}\u5C0F\u65F6${d}\u5206\u949F${c}\u79D2`}checkExplorationCompletion(){if(!this.explorationType||!this.explorationStartTime)return"";let t={\u8FD1\u6D77\u8FDC\u822A:{duration:5*60*60*1e3,reward:{minGold:1200,maxGold:1500,seeds:7}},\u8FDC\u6D77\u63A2\u7D22:{duration:8*60*60*1e3,reward:{minGold:3200,maxGold:4e3,seeds:15,fish:5}},\u968F\u673A\u63A2\u7D22:{duration:12*60*60*1e3,reward:{minGold:3e3,maxGold:8e3,seeds:{min:10,max:20},fish:{min:3,max:10}}}}[this.explorationType];if(Date.now()-this.explorationStartTime>=t.duration){let o=t.reward,h=Math.floor(Math.random()*(o.maxGold-o.minGold+1))+o.minGold;this.money+=h;let d=Object.keys(T).filter(g=>g.endsWith("\u79CD\u5B50")),c=d[Math.floor(Math.random()*d.length)],m=o.seeds;this.warehouse[c]||(this.warehouse[c]=0),this.warehouse[c]+=m;let p="";if(o.fish){let g=Object.keys(this.warehouse).filter($=>this.isFish($)),x=g[Math.floor(Math.random()*g.length)],C=o.fish;this.warehouse[x]||(this.warehouse[x]=0),this.warehouse[x]+=C,p=`\u548C${x}\xD7${C}`}return this.explorationType=null,this.explorationStartTime=null,this.saveData(),`[CQ:at,qq=${parseInt(this.id.replace("QQ:",""))}]\u4F60\u7684\u8239\u961F\u5F52\u6765\u5566\uFF0C\u5E26\u56DE\u4E86${h}\u91D1\u5E01\u3001${c}\xD7${m}mp${p}`}return""}isFish(e){return["\u9CA4\u9C7C","\u9CB1\u9C7C","\u5C0F\u5634\u9C88\u9C7C","\u592A\u9633\u9C7C","\u9CC0\u9C7C","\u6C99\u4E01\u9C7C","\u6CB3\u9C88","\u9CA2\u9C7C","\u9CB7\u9C7C","\u7EA2\u9CB7\u9C7C","\u6D77\u53C2","\u8679\u9CDF\u9C7C","\u5927\u773C\u9C7C","\u897F\u9CB1","\u5927\u5934\u9C7C","\u5927\u5634\u9C88\u9C7C","\u9C91\u9C7C","\u9B3C\u9C7C","\u7F57\u975E\u9C7C","\u6728\u8DC3\u9C7C","\u72EE\u5B50\u9C7C","\u6BD4\u76EE\u9C7C","\u5927\u6BD4\u76EE\u9C7C","\u5348\u591C\u9CA4\u9C7C","\u53F2\u83B1\u59C6\u9C7C","\u867E\u864E\u9C7C","\u7EA2\u9CBB\u9C7C","\u9752\u82B1\u9C7C","\u72D7\u9C7C","\u864E\u7EB9\u9CDF\u9C7C","\u84DD\u94C1\u997C\u9C7C","\u6C99\u9C7C"].includes(e)}toJSON(){let e={};for(let t in this)t!=="weatherSystem"&&(e[t]=this[t]);return e}};(()=>{let v=M.getInstance();function e(){if(!seal.ext.find("\u6211\u7684\u519C\u7530\u63D2\u4EF6")){let U=function(r,a,l,n,i,u){let f=Q(r,a,l,n,i);!f||f.length&&f.length<2||seal.replyToSender(f[0],f[1],u)},Q=function(r,a,l,n,i){let u=seal.getEndPoints();for(let f=0;f<u.length;f++)if(u[f].userId===r){let w=seal.newMessage();return i===!0?w.messageType="private":(w.messageType="group",w.groupId=l,w.guildId=a),w.sender.userId=n,[seal.createTempCtx(u[f],w),w]}},s=seal.ext.new("\u6211\u7684\u519C\u7530\u63D2\u4EF6","bug\u4EBA@","1.0.0"),o=Date.now().toString();setTimeout(()=>{s.storageSet("taskId",o)},500);let h=()=>{setTimeout(()=>{let r=seal.ext.find("\u6211\u7684\u519C\u7530\u63D2\u4EF6");try{if(r&&r.storageGet&&typeof r.storageGet=="function"&&r.storageGet("taskId")===o){h();let a=seal.ext.find("\u6211\u7684\u519C\u7530\u63D2\u4EF6").storageGet("VoyageTasks"),l=a?JSON.parse(a):[],n=[];l.forEach(i=>{if(i.reachTime<Date.now()){let f=I.getData(i.userId).checkExplorationCompletion();U(...i.replyCtx,f)}else n.push(i)}),l.length!==n.length&&seal.ext.find("\u6211\u7684\u519C\u7530\u63D2\u4EF6").storageSet("VoyageTasks",JSON.stringify(n))}}catch(a){console.log("err",a)}},5e3)};h();let d={name:"\u6210\u4E3A\u519C\u592B",help:"\u6307\u4EE4\uFF1A.\u6210\u4E3A\u519C\u592B",solve:(r,a,l)=>t(r,a,l,(n,i,u)=>(n?seal.replyToSender(r,a,"\u54CE\u5440~\u4F60\u5DF2\u7ECF\u662F\u519C\u592B\u4E86\uFF0C\u96BE\u9053\u5FD8\u8BB0\u4E86\u5417\uFF1F"):(n=new P(i,u),n.saveData(),seal.replyToSender(r,a,`\u606D\u559C\u4F60\u6210\u4E3A\u519C\u592B\uFF01
\u73B0\u5728\u4F60\u62E5\u67096\u5757\u7530\u5730\u3001200\u91D1\u5E01\u548C\u9632\u98CE\u8349\u79CD\u5B50\xD76~
x\u73B0\u5728\u4F60\u7684\u7B49\u7EA7\u4E3A1\uFF0C\u7ECF\u9A8C\u503C\u4E3A0\uFF0C\u52A0\u6CB9\u5427\uFF01

\u8BF7\u4F7F\u7528\u201C.\u519C\u573A\u6307\u4EE4\u201D\u67E5\u770B\u76F8\u5173\u6307\u4EE4`)),seal.ext.newCmdExecuteResult(!0))),allowDelegate:!1,disabledInPrivate:!1},c={name:"\u519C\u573A\u6307\u4EE4",help:"\u6307\u4EE4\uFF1A.\u519C\u573A\u6307\u4EE4",solve:(r,a)=>(seal.replyToSender(r,a,`
    \u519C\u573A\u6307\u4EE4\u5E2E\u52A9\u4FE1\u606F\uFF1A
    .\u7B7E\u5230 - \u7B7E\u5230\u5E76\u83B7\u5F97\u6BCF\u65E5\u5956\u52B1

    .\u6211\u7684\u519C\u7530 - \u67E5\u770B\u6211\u7684\u519C\u7530\u4FE1\u606F
    .\u79CD\u690D<\u519C\u4F5C\u7269><\u6570\u91CF> - \u79CD\u690D\u519C\u4F5C\u7269\uFF08\u6570\u91CF\u548C\u7269\u54C1\u95F4\u8BF7\u52A0\u7A7A\u683C\uFF09
    .\u519C\u7530\u5546\u5E97 - \u67E5\u770B\u519C\u7530\u5546\u5E97
    .\u8D2D\u4E70 <\u5546\u54C1\u540D>\uFF08\u6570\u91CF\uFF09 - \u8D2D\u4E70\u5546\u54C1\uFF08\u6570\u91CF\u548C\u7269\u54C1\u95F4\u8BF7\u52A0\u7A7A\u683C\uFF09
    .\u51FA\u552E <\u5546\u54C1\u540D>\uFF08\u6570\u91CF\uFF09 - \u51FA\u552E\u5546\u54C1\uFF08\u6570\u91CF\u548C\u7269\u54C1\u95F4\u8BF7\u52A0\u7A7A\u683C\uFF09
    .\u597D\u53CB\u4FE1\u606F<@\u5176\u4ED6\u4EBA> - \u67E5\u770B\u597D\u53CB\u7684\u519C\u7530\u4FE1\u606F
    .\u6211\u7684\u4ED3\u5E93 - \u67E5\u770B\u6211\u7684\u4ED3\u5E93

    .\u94F2\u9664\u519C\u7530<\u7530\u5730\u540D> - \u94F2\u9664\u519C\u7530\u4E2D\u7684\u4F5C\u7269
    .\u5077\u7A83<@\u5176\u4ED6\u4EBA> - \u5077\u7A83\u5176\u4ED6\u4EBA\u7684\u4F5C\u7269
    .\u6536\u83B7 - \u6536\u83B7\u6240\u6709\u6210\u719F\u7684\u4F5C\u7269
    .\u4E22\u5F03 <\u7269\u54C1\u540D>\uFF08\u6570\u76EE\uFF09 - \u4E22\u5F03\u7269\u54C1\uFF08\u6570\u91CF\u548C\u7269\u54C1\u95F4\u8BF7\u52A0\u7A7A\u683C\uFF09
    .\u4FEE\u6539\u519C\u592B\u540D<\u65B0\u7528\u6237\u540D> - \u4FEE\u6539\u519C\u592B\u540D
    .\u4F7F\u7528\u80A5\u6599 <\u7530\u5730\u540D> - \u4F7F\u7528\u80A5\u6599\u7F29\u77ED\u65F6\u95F4

    .\u9493\u9C7C - \u5728\u9C7C\u5858\u9493\u9C7C
    .\u6293\u86AF\u8693 - \u6293\u86AF\u8693\u8F6C\u6362\u4E3A\u9C7C\u9975
    .\u8FDC\u822A - \u6D3E\u9063\u8239\u961F\u8FDC\u822A\u63A2\u7D22
    .\u519C\u573A\u6307\u4EE4 - \u67E5\u770B\u519C\u573A\u6307\u4EE4\u5E2E\u52A9\u4FE1\u606F
    `),seal.ext.newCmdExecuteResult(!0)),allowDelegate:!1,disabledInPrivate:!1},m={name:"\u6211\u7684\u519C\u7530",help:"\u6307\u4EE4\uFF1A.\u6211\u7684\u519C\u7530",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);v.updateWeather();let i=new Date,u=`${i.getMonth()+1}\u6708${i.getDate()}\u65E5`,f=v.getWeatherInfo(),w=n.getFarmInfo(),b=`\u7528\u6237\u540D: ${n.name}
\u65E5\u671F\uFF1A${u}
${f}
${w}`;return seal.replyToSender(r,a,b),seal.ext.newCmdExecuteResult(!0)}),allowDelegate:!1,disabledInPrivate:!1},p={name:"\u79CD\u690D",help:"\u6307\u4EE4\uFF1A.\u79CD\u690D<\u519C\u4F5C\u7269><\u6570\u91CF>",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let i=l.getArgN(1),u=parseInt(l.getArgN(2));return isNaN(u)||u<=0?(seal.replyToSender(r,a,"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u6570\u91CF\u5566..."),seal.ext.newCmdExecuteResult(!0)):(seal.replyToSender(r,a,n.plantCrop(i,u)),seal.ext.newCmdExecuteResult(!0))}),allowDelegate:!1,disabledInPrivate:!1},y={name:"\u519C\u7530\u5546\u5E97",help:"\u6307\u4EE4\uFF1A.\u519C\u7530\u5546\u5E97",solve:(r,a,l)=>t(r,a,l,n=>n?(seal.replyToSender(r,a,n.getStoreInfo()),seal.ext.newCmdExecuteResult(!0)):(seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0))),allowDelegate:!1,disabledInPrivate:!1},g={name:"\u8D2D\u4E70",help:"\u6307\u4EE4\uFF1A.\u8D2D\u4E70 <\u5546\u54C1\u540D>\uFF08\u6570\u91CF\uFF09",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let i=l.getArgN(1),u=parseInt(l.getArgN(2))||1;return seal.replyToSender(r,a,n.buyItem(i,u)),seal.ext.newCmdExecuteResult(!0)}),allowDelegate:!1,disabledInPrivate:!1},x={name:"\u51FA\u552E",help:"\u6307\u4EE4\uFF1A.\u51FA\u552E <\u5546\u54C1\u540D>\uFF08\u6570\u91CF\uFF09",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let i=l.getArgN(1),u=parseInt(l.getArgN(2))||1;return seal.replyToSender(r,a,n.sellItem(i,u)),seal.ext.newCmdExecuteResult(!0)}),allowDelegate:!1,disabledInPrivate:!1},C={name:"\u597D\u53CB\u4FE1\u606F",help:"\u6307\u4EE4\uFF1A.\u597D\u53CB\u4FE1\u606F<\u5176\u4ED6\u4EBA>",allowDelegate:!0,solve:(r,a,l)=>{let n=seal.getCtxProxyFirst(r,l);return t(n,a,l,i=>i?(seal.replyToSender(r,a,i.getFarmInfo()),seal.ext.newCmdExecuteResult(!0)):(seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0)))},disabledInPrivate:!1},$={name:"\u6211\u7684\u4ED3\u5E93",help:"\u6307\u4EE4\uFF1A.\u6211\u7684\u4ED3\u5E93",solve:(r,a,l)=>t(r,a,l,n=>n?(seal.replyToSender(r,a,n.getWarehouseInfo()),seal.ext.newCmdExecuteResult(!0)):(seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0))),allowDelegate:!1,disabledInPrivate:!1},D={name:"\u94F2\u9664\u519C\u7530",help:"\u6307\u4EE4\uFF1A.\u94F2\u9664\u519C\u7530<\u5E8F\u53F7>",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let i=l.getArgN(1);return seal.replyToSender(r,a,n.removeCrop(i)),seal.ext.newCmdExecuteResult(!0)}),allowDelegate:!1,disabledInPrivate:!1},W={name:"\u5077\u7A83",help:"\u6307\u4EE4\uFF1A.\u5077\u7A83<\u5176\u4ED6\u4EBA>",allowDelegate:!0,solve:(r,a,l)=>{let n=seal.getCtxProxyFirst(r,l);return t(n,a,l,i=>{let u=a.sender.userId;if(i=I.getData(u),!i)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let f=seal.getCtxProxyFirst(r,l),w=I.getData(f.player.userId);if(!w)return seal.replyToSender(r,a,"\u8FD9\u4E2A\u4EBA\u8FD8\u6CA1\u6709\u6210\u4E3A\u519C\u592B\u54E6\uFF0C\u8981\u4E0D\u8981\u8BD5\u7740\u8BA9\u4ED6\u4E5F\u52A0\u5165\u4F60\u5440~\u3002"),seal.ext.newCmdExecuteResult(!0);let b=new Date().getTime();if(i.getLastStealTime()!=0&&b-i.getLastStealTime()<6e4){let G=Math.ceil((6e4-(b-i.getLastStealTime()))/1e3);return seal.replyToSender(r,a,`\u9644\u8FD1\u8FD8\u6709\u4EBA\u770B\u7740\u5462\uFF0C\u518D\u7B49${G}\u79D2\u540E\u518D\u8BD5\u5427...`),seal.ext.newCmdExecuteResult(!0)}let S=i.stealCrop(w);return seal.replyToSender(r,a,S),seal.ext.newCmdExecuteResult(!0)})},disabledInPrivate:!1},k={name:"\u6536\u83B7",help:"\u6307\u4EE4\uFF1A.\u6536\u83B7",solve:(r,a,l)=>t(r,a,l,n=>n?(console.log("\u6536\u83B7\u6307\u4EE4: \u4E00\u952E\u6536\u83B7"),seal.replyToSender(r,a,n.harvestCrop("all")),seal.ext.newCmdExecuteResult(!0)):(seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0))),allowDelegate:!1,disabledInPrivate:!1},R={name:"\u4E22\u5F03",help:"\u6307\u4EE4\uFF1A.\u4E22\u5F03 <\u7269\u54C1\u540D>\uFF08\u6570\u76EE\uFF09",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let i=l.getArgN(1),u=parseInt(l.getArgN(2))||1;console.log(`\u4E22\u5F03\u6307\u4EE4: \u7269\u54C1: ${i}, \u6570\u91CF: ${u}`);let f=n.discardItem(i,u);return console.log(`\u4E22\u5F03\u7ED3\u679C: ${f}`),seal.replyToSender(r,a,f),seal.ext.newCmdExecuteResult(!0)}),allowDelegate:!1,disabledInPrivate:!1},N={name:"\u4FEE\u6539\u519C\u592B\u540D",help:"\u6307\u4EE4\uFF1A.\u4FEE\u6539\u519C\u592B\u540D<\u65B0\u7528\u6237\u540D>",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let i=l.getArgN(1),u=n.changeName(i);return seal.replyToSender(r,a,u),seal.ext.newCmdExecuteResult(!0)}),allowDelegate:!1,disabledInPrivate:!1},F={name:"\u4F7F\u7528\u80A5\u6599",help:"\u6307\u4EE4\uFF1A.\u4F7F\u7528\u80A5\u6599 <\u7530\u5730\u5E8F\u53F7>",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let i=l.getArgN(1),u=n.useFertilizer(i);return seal.replyToSender(r,a,u),seal.ext.newCmdExecuteResult(!0)}),allowDelegate:!1,disabledInPrivate:!1},H={name:"\u7B7E\u5230",help:"\u6307\u4EE4\uFF1A.\u7B7E\u5230",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let i=new Date,u=i.toDateString();if(n.lastSignInDate===u){v.updateWeather();let G=`${i.getMonth()+1}\u6708${i.getDate()}\u65E5`,A=v.getWeatherInfo(),E=`\u4ECA\u5929\u5DF2\u7ECF\u6253\u8FC7\u62DB\u547C\u4E86\u5427\uFF01\u8FD8\u662F\u8BF4\uFF0C\u4F60\u662F\u6765\u770B\u770B\u65E5\u5386\u770B\u770B\u5929\u6C14\u7684\uFF1F
\u65E5\u671F\uFF1A${G}
${A}`;switch(v.getCurrentWeather()){case"\u6674\u5929":E+=`
\u54E6\u5440\u54E6\u5440\uFF0C\u662F\u4E2A\u5927\u6674\u5929\u5462~\uFF08\u65E0\u589E\u76CA\u5929\u6C14\uFF09`;break;case"\u96E8\u5929":E+=`
\u4E0B\u96E8\u4E86\uFF0C\u662F\u690D\u7269\u4EEC\u559C\u6B22\u7684\u65E5\u5B50\u5462~\uFF08\u6536\u83B7\u65F6\u95F4\u7F29\u77ED\uFF0C\u53EF\u4EE5\u6293\u86AF\u8693\uFF09`;break;case"\u5E72\u65F1":E+=`
\u771F\u662F\u706B\u70ED\u7684\u5929\u6C14...\u522B\u5FD8\u4E86\u7ED9\u519C\u7530\u6D47\u6C34\uFF08\u6536\u83B7\u65F6\u95F4\u5EF6\u957F\uFF09`;break;case"\u66B4\u98CE\u96E8":E+=`
\u54CE\u5440\uFF01\u4ECA\u5929\u66B4\u98CE\u96E8\u8981\u6765\u4E86\uFF0C\u6CE8\u610F\u4F5C\u7269\u522B\u88AB\u5439\u8DD1\u4E86\uFF01\uFF08\u6536\u83B7\u65F6\u95F4\u5927\u5E45\u5EF6\u957F\uFF09`;break;case"\u4E30\u6536\u65E5":E+=`
\u771F\u662F\u4EE4\u4EBA\u795E\u6E05\u6C14\u723D\u7684\u597D\u65E5\u5B50\uFF0C\u4F60\u8BF4\u662F\u4E0D\u662F~\uFF08\u6536\u83B7\u65F6\u95F4\u5927\u5E45\u7F29\u77ED\uFF09`;break}return seal.replyToSender(r,a,E),seal.ext.newCmdExecuteResult(!0)}v.updateWeather();let f=`${i.getMonth()+1}\u6708${i.getDate()}\u65E5`,w=v.getWeatherInfo(),b=Math.floor(Math.random()*31)+20;n.money+=b,n.lastSignInDate=u,n.saveData();let S=`\u7B7E\u5230\u6210\u529F\uFF01
\u65E5\u671F\uFF1A${f}
${w}
\u83B7\u5F97${b}\u91D1\u5E01\u3002`;switch(v.getCurrentWeather()){case"\u6674\u5929":S+=`
\u54E6\u5440\u54E6\u5440\uFF0C\u662F\u4E2A\u5927\u6674\u5929\u5462~\uFF08\u65E0\u589E\u76CA\u5929\u6C14\uFF09`;break;case"\u96E8\u5929":S+=`
\u4E0B\u96E8\u4E86\uFF0C\u662F\u690D\u7269\u4EEC\u559C\u6B22\u7684\u65E5\u5B50\u5462~\uFF08\u6536\u83B7\u65F6\u95F4\u7F29\u77ED\uFF0C\u53EF\u4EE5\u6293\u86AF\u8693\uFF09`;break;case"\u5E72\u65F1":S+=`
\u771F\u662F\u706B\u70ED\u7684\u5929\u6C14...\u522B\u5FD8\u4E86\u7ED9\u519C\u7530\u6D47\u6C34\uFF08\u6536\u83B7\u65F6\u95F4\u5EF6\u957F\uFF09`;break;case"\u66B4\u98CE\u96E8":S+=`
\u54CE\u5440\uFF01\u4ECA\u5929\u66B4\u98CE\u96E8\u8981\u6765\u4E86\uFF0C\u6CE8\u610F\u4F5C\u7269\u522B\u88AB\u5439\u8DD1\u4E86\uFF01\uFF08\u6536\u83B7\u65F6\u95F4\u5927\u5E45\u5EF6\u957F\uFF09`;break;case"\u4E30\u6536\u65E5":S+=`
\u771F\u662F\u4EE4\u4EBA\u795E\u6E05\u6C14\u723D\u7684\u597D\u65E5\u5B50\uFF0C\u4F60\u8BF4\u662F\u4E0D\u662F~\uFF08\u6536\u83B7\u65F6\u95F4\u5927\u5E45\u7F29\u77ED\uFF09`;break}return seal.replyToSender(r,a,S),seal.ext.newCmdExecuteResult(!0)}),allowDelegate:!1,disabledInPrivate:!1},j={name:"\u9493\u9C7C",help:"\u6307\u4EE4\uFF1A.\u9493\u9C7C",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let i=n.fish();return seal.replyToSender(r,a,i),seal.ext.newCmdExecuteResult(!0)}),allowDelegate:!1,disabledInPrivate:!1},J={name:"\u6293\u86AF\u8693",help:"\u6307\u4EE4\uFF1A.\u6293\u86AF\u8693",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let u=I.getData(n.id).catchWorms();return seal.replyToSender(r,a,u),seal.ext.newCmdExecuteResult(!0)}),allowDelegate:!1,disabledInPrivate:!1},L={name:"\u8FDC\u822A",help:"\u6307\u4EE4\uFF1A.\u8FDC\u822A",solve:(r,a,l)=>t(r,a,l,n=>{if(!n)return seal.replyToSender(r,a,"\u4F60\u8FD8\u4E0D\u662F\u519C\u592B\u54E6\uFF0C\u8BD5\u7740\u7528.\u6210\u4E3A\u519C\u592B\u6307\u4EE4\u52A0\u5165\u5927\u5BB6\u5427\uFF01"),seal.ext.newCmdExecuteResult(!0);let i=I.getData(n.id),u=i.getExplorationType();if(u){let w=i.getExplorationRemainingTime();return console.log(`\u5F53\u524D\u8FDC\u822A\u72B6\u6001: ${u}, \u5269\u4F59\u65F6\u95F4: ${w}`),w.includes("\u79D2")?seal.replyToSender(r,a,`\u4F60\u7684\u8239\u961F\u6B63\u5728\u63A2\u7D22\u4E2D\uFF0C\u8BA9\u6211\u770B\u770B...\u55EF\uFF0C\u8FD8\u6709${w}\u624D\u4F1A\u56DE\u6765\u54E6~`):seal.replyToSender(r,a,w),seal.ext.newCmdExecuteResult(!0)}let f=i.explore(l.getArgN(1),r,a);return seal.replyToSender(r,a,f),seal.ext.newCmdExecuteResult(!0)}),allowDelegate:!1,disabledInPrivate:!1};s.cmdMap.\u6210\u4E3A\u519C\u592B=d,s.cmdMap.\u519C\u573A\u6307\u4EE4=c,s.cmdMap.\u6211\u7684\u519C\u7530=m,s.cmdMap.\u79CD\u690D=p,s.cmdMap.\u519C\u7530\u5546\u5E97=y,s.cmdMap.\u8D2D\u4E70=g,s.cmdMap.\u51FA\u552E=x,s.cmdMap.\u597D\u53CB\u4FE1\u606F=C,s.cmdMap.\u6211\u7684\u4ED3\u5E93=$,s.cmdMap.\u94F2\u9664\u519C\u7530=D,s.cmdMap.\u5077\u7A83=W,s.cmdMap.\u6536\u83B7=k,s.cmdMap.\u4E22\u5F03=R,s.cmdMap.\u4FEE\u6539\u519C\u592B\u540D=N,s.cmdMap.\u4F7F\u7528\u80A5\u6599=F,s.cmdMap.\u7B7E\u5230=H,s.cmdMap.\u9493\u9C7C=j,s.cmdMap.\u6293\u86AF\u8693=J,s.cmdMap.\u8FDC\u822A=L,seal.ext.register(s)}}function t(s,o,h,d){let c=s.player.userId,m=s.player.name,p=I.getData(c);return d(p,c,m)}e()})();})();
